

<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Registro &mdash; documentación de teamDC - 0.0.1</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/translations.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="next" title="Registros" href="registros.html" />
    <link rel="prev" title="Mi Perfil" href="mi%20Perfil.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> teamDC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="descripcion.html">Descripción</a></li>
<li class="toctree-l1"><a class="reference internal" href="home.html">Página de Inicio</a></li>
<li class="toctree-l1"><a class="reference internal" href="login.html">Login</a></li>
<li class="toctree-l1"><a class="reference internal" href="mi%20Perfil.html">Mi Perfil</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Registro</a></li>
<li class="toctree-l1"><a class="reference internal" href="registros.html">Registros</a></li>
<li class="toctree-l1"><a class="reference internal" href="video.html">Video</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">teamDC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Registro</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/registro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="registro">
<h1>Registro<a class="headerlink" href="#registro" title="Enlazar permanentemente con este título">¶</a></h1>
<ol class="arabic">
<li><dl class="simple">
<dt>Descripción</dt><dd><p>En este componente se debe mostrar todos los registros almacenados en la base de datos.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Importaciones</dt><dd><p>Para este componente de debe importar el servicio a la base de datos, el servicio para la
autentificación de usuarios y el servicio a una API para obtener los municipios y departamentos
de Colombia.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">{</span> <span class="n">RegistrosService</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;src/app/services/registros.service&#39;</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">AngularFireAuth</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;@angular/fire/auth&#39;</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span><span class="n">MunicipiosColombiaService</span><span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;src/app/services/municipios-colombia.service&#39;</span>
</pre></div>
</div>
<p>También se importan componentes de Angular Material para la implementación de ventana
emergente o modal y de se importa el componente Router para un redireccionamiento al
concluir el registro.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="p">{</span> <span class="n">MatDialog</span><span class="p">,</span> <span class="n">MatDialogConfig</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;@angular/material/dialog&#39;</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">DialogComponent</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;../dialog/dialog.component&#39;</span><span class="p">;</span>
<span class="kn">import</span> <span class="p">{</span> <span class="n">Router</span> <span class="p">}</span> <span class="kn">from</span> <span class="s1">&#39;@angular/router&#39;</span><span class="p">;</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Desarrollo</dt><dd><p>El constructor se inyectan todos los objetos a necesarios para el desarrollo del componente.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">private</span> <span class="n">afAuth</span><span class="p">:</span> <span class="n">AngularFireAuth</span><span class="p">,</span>
<span class="n">private</span> <span class="n">registrosServiceF</span> <span class="p">:</span> <span class="n">RegistrosService</span><span class="p">,</span>
<span class="n">private</span> <span class="n">municipiosService</span><span class="p">:</span><span class="n">MunicipiosColombiaService</span><span class="p">,</span>
<span class="n">private</span> <span class="n">matDialog</span><span class="p">:</span> <span class="n">MatDialog</span><span class="p">,</span>
<span class="n">private</span> <span class="n">router</span><span class="p">:</span><span class="n">Router</span><span class="p">,</span>
<span class="n">private</span> <span class="n">fb</span><span class="p">:</span><span class="n">FormBuilder</span>
</pre></div>
</div>
<p>Para la captura de datos se emplea los formularios reactivos, para ello se declara un
objeto de la clase FormGroup y se inicializa creando un FormControl para cada campo requerido,
declarando su estado y sus respectivo valida daciones.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">fb</span><span class="o">.</span><span class="n">group</span><span class="p">({</span>
    <span class="n">photoUrl</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="n">cedula</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">validarCedula</span><span class="p">]),</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="o">.</span>
    <span class="n">descripcion</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">]),</span>
    <span class="p">})</span>
</pre></div>
</div>
<p>En el método ngOnInit se realiza la obtención de todos los registros almacenados en la
base de datos con el fin de realizar validaciones con dichos datos, estos datos son
almacenados en un array.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">this</span><span class="o">.</span><span class="n">registrosServiceF</span><span class="o">.</span><span class="n">getRegistros</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span><span class="p">((</span><span class="n">rgSnapshot</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
<span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">rgSnapshot</span><span class="o">.</span><span class="n">forEach</span><span class="p">((</span><span class="n">rgData</span><span class="p">:</span> <span class="nb">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span><span class="o">.</span><span class="n">push</span><span class="p">({</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">rgData</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">rgData</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>

    <span class="p">});</span>
<span class="p">})</span>
<span class="p">});</span>
</pre></div>
</div>
<p>En el mismo método se obtienen los datos de la API sobre los municipios y
departamentos de Colombia y se asignan en un array.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">this</span><span class="o">.</span><span class="n">municipiosService</span><span class="o">.</span><span class="n">getDatos</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="n">datos</span> <span class="o">=&gt;</span><span class="p">{</span>
    <span class="o">//</span> <span class="n">Se</span> <span class="n">almacenan</span> <span class="n">los</span> <span class="n">municipios</span>
    <span class="n">this</span><span class="o">.</span><span class="n">datosMunicipios</span><span class="o">=</span><span class="n">datos</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data</span><span class="o">=&gt;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">municipio</span><span class="p">);</span>
    <span class="o">//</span> <span class="n">Se</span> <span class="n">almacenan</span> <span class="n">los</span> <span class="n">departamentos</span>
    <span class="n">this</span><span class="o">.</span><span class="n">datosDepartamentos</span><span class="o">=</span><span class="n">datos</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">data</span><span class="o">=&gt;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">departamento</span><span class="p">);</span>

    <span class="o">//</span> <span class="n">Se</span> <span class="n">elimina</span> <span class="n">los</span> <span class="n">departamentos</span> <span class="n">repetidos</span>
    <span class="n">let</span> <span class="n">NuevosDatosDepartamentos</span><span class="p">:</span><span class="n">string</span><span class="p">[]</span><span class="o">=</span><span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">posicion</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">posicion</span> <span class="o">&lt;</span> <span class="n">this</span><span class="o">.</span><span class="n">datosDepartamentos</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">posicion</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">element</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">datosDepartamentos</span><span class="p">[</span><span class="n">posicion</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="n">posicion</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">NuevosDatosDepartamentos</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">toString</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="k">else</span><span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">NuevosDatosDepartamentos</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">toString</span><span class="p">())</span><span class="o">==</span><span class="n">false</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="n">NuevosDatosDepartamentos</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">toString</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>En el método ngOnInit también se declara un array observador para municipio y otro para departamento
encargado del filtrado en el componente html.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">this</span><span class="o">.</span><span class="n">filteredMunicipios</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">ciudad</span><span class="o">.</span><span class="n">valueChanges</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span>
        <span class="n">startWith</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
        <span class="nb">map</span><span class="p">(</span><span class="n">value</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">_filterMunicipios</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="p">);</span>


    <span class="n">this</span><span class="o">.</span><span class="n">filteredDepartamentos</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">departamento</span><span class="o">.</span><span class="n">valueChanges</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span>
    <span class="n">startWith</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
    <span class="nb">map</span><span class="p">(</span><span class="n">value</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">_filterDepartamentos</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="p">);</span>
</pre></div>
</div>
<p>Al mismo tiempo se realiza a los métodos que devuelve un array con las filtraciones realizadas</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_filterMunicipios</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">string</span><span class="p">[]</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">filterValue</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">toLowerCase</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">datosMunicipios</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">option</span> <span class="o">=&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">toLowerCase</span><span class="p">()</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="n">filterValue</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">_filterDepartamentos</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">string</span><span class="p">[]</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">filterValue</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">toLowerCase</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">datosDepartamentos</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">option</span> <span class="o">=&gt;</span> <span class="n">option</span><span class="o">.</span><span class="n">toLowerCase</span><span class="p">()</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="n">filterValue</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cada campo del formulario tiene su respectivo control y todos son requeridos, ahora hay campos
especiales que requieren validaciones personalizadas empezando por el campo del numero de
cedula el cual no debe estar registrado con anterioridad en la base de datos.</p>
<p>En la declaración del control de para el campo de cedula se añade su validador personalizado</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cedula</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">validarCedula</span><span class="p">]),</span>
</pre></div>
</div>
<p>Para la validación personalizada se crea el siguiente método.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">private</span> <span class="n">validarCedula</span><span class="p">:</span> <span class="n">ValidatorFn</span> <span class="o">=</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">AbstractControl</span><span class="p">):</span> <span class="n">ValidationErrors</span> <span class="o">|</span> <span class="n">null</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">cedula</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
    <span class="n">let</span> <span class="n">respuesta</span><span class="o">=</span> <span class="n">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">ValidarExistenciaCedula</span><span class="p">(</span><span class="n">cedula</span><span class="p">)</span><span class="o">==</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">{</span> <span class="n">ms</span><span class="p">:</span> <span class="s1">&#39;para otro forma de error&#39;</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Internamente este método llama a otro método encargado de revisar si la cedula ya existe
en los registros obtenidos de la base de datos.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ValidarExistenciaCedula</span><span class="p">(</span><span class="n">cedulaIn</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">boolean</span> <span class="p">{</span>
    <span class="n">let</span> <span class="n">existeCedula</span><span class="p">:</span> <span class="n">boolean</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
    <span class="n">let</span> <span class="n">respuesta</span><span class="p">:</span> <span class="n">boolean</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="o">//</span> <span class="n">Se</span> <span class="n">compara</span> <span class="n">la</span> <span class="n">cedula</span> <span class="n">ingresada</span> <span class="n">con</span> <span class="n">la</span> <span class="n">cedula</span> <span class="n">de</span> <span class="n">cada</span> <span class="n">registro</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">element</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">const</span> <span class="p">{</span> <span class="n">cedula</span> <span class="p">}</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">data</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cedulaIn</span> <span class="o">==</span> <span class="n">cedula</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">existeCedula</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">existeCedula</span> <span class="o">==</span> <span class="n">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">respuesta</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
    <span class="n">respuesta</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">respuesta</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cuando hay la validación verifica la existencia de la cedula ingresada en los registros de
la base de datos, el formulario informa inmediatamente al usuario que hay un erro mediante
el uso de formularios reactivos y la sincronización entre la vista y el controlador.</p>
<p>Campo de Cedula en el HTML</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span> <span class="n">appearance</span><span class="o">=</span><span class="s2">&quot;outline&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span><span class="n">Número</span> <span class="n">de</span> <span class="n">cédula</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">input</span> <span class="n">matInput</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;number&quot;</span> <span class="n">formControlName</span><span class="o">=</span><span class="s2">&quot;cedula&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span> <span class="o">*</span><span class="n">ngIf</span><span class="o">=</span><span class="s2">&quot;registerForm.controls.cedula.errors&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">errorCedula</span><span class="p">()}}</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Método encargado de informar el tipo de error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">errorCedula</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">cedula</span><span class="o">.</span><span class="n">hasError</span><span class="p">(</span><span class="s1">&#39;required&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;Ingrese un número de cédula&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">cedula</span><span class="o">.</span><span class="n">hasError</span><span class="p">(</span><span class="s1">&#39;ms&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;El número de cedula ya ha sido registrado&#39;</span><span class="p">;</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>El mismo comportamiento presenta el campo de Email.</p>
<p>Declaración del control email con su validador personalizado</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">email</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">,</span> <span class="n">Validators</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">validarEmail</span><span class="p">]),</span>
</pre></div>
</div>
<p>Metodo para la validación personalizada.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">private</span> <span class="n">validarEmail</span><span class="p">:</span> <span class="n">ValidatorFn</span> <span class="o">=</span><span class="p">(</span><span class="n">control</span><span class="p">:</span> <span class="n">AbstractControl</span><span class="p">):</span> <span class="n">ValidationErrors</span> <span class="o">|</span> <span class="n">null</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">email</span> <span class="o">=</span> <span class="n">control</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
    <span class="n">let</span> <span class="n">respuesta</span><span class="o">=</span> <span class="n">null</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">ValidarExistenciaCorreo</span><span class="p">(</span><span class="n">email</span><span class="p">)</span><span class="o">==</span><span class="n">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">{</span> <span class="n">ms</span><span class="p">:</span> <span class="s1">&#39;para otro forma de error&#39;</span> <span class="p">};</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">null</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Método encargado de revisar si el email ya existe en los registros obtenidos de la base de datos.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ValidarExistenciaCorreo</span><span class="p">(</span><span class="n">correo</span><span class="p">:</span> <span class="n">string</span><span class="p">):</span> <span class="n">boolean</span> <span class="p">{</span>
    <span class="n">let</span> <span class="n">existeCorreo</span><span class="p">:</span> <span class="n">boolean</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
    <span class="n">let</span> <span class="n">respuesta</span><span class="p">:</span> <span class="n">boolean</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="o">//</span> <span class="n">Se</span> <span class="n">compara</span> <span class="n">el</span> <span class="n">correo</span> <span class="n">ingresado</span> <span class="n">con</span> <span class="n">el</span> <span class="n">email</span> <span class="n">de</span> <span class="n">cada</span> <span class="n">registro</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">const</span> <span class="n">element</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">listaRegistros</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">const</span> <span class="p">{</span> <span class="n">email</span> <span class="p">}</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">data</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">correo</span> <span class="o">==</span> <span class="n">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">existeCorreo</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">existeCorreo</span> <span class="o">==</span> <span class="n">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">respuesta</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="n">respuesta</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">respuesta</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Campo de Email en el HTML</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span> <span class="n">appearance</span><span class="o">=</span><span class="s2">&quot;outline&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span><span class="n">E</span><span class="o">-</span><span class="n">mail</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">input</span> <span class="n">matInput</span> <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;example@example.com&quot;</span> <span class="n">formControlName</span><span class="o">=</span><span class="s2">&quot;email&quot;</span> <span class="n">required</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span> <span class="o">*</span><span class="n">ngIf</span><span class="o">=</span><span class="s2">&quot;registerForm.controls.email.errors&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">errorEmail</span><span class="p">()}}</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span> <span class="o">&gt;</span>
</pre></div>
</div>
<p>Método encargado de informar el tipo de error</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>errorEmail() {
    if (this.registerForm.controls.email.hasError(&#39;required&#39;)) {
        return &#39;Debe ingresar un email&#39;;
    }
    if (this.registerForm.controls.email.hasError(&#39;ms&#39;)) {
        return &#39;El email ya ha sido registrado&#39;;
    }
    return this.registerForm.controls.email.hasError(&#39;email&#39;) ? &#39;Email no válido&#39; : &#39;&#39;;
}
</pre></div>
</div>
<p>Otro de los campos con funciones especiales son los de municipio y departamento que emplean un filtro
de autocompletado y su estructura en HTML es el siguiente aplicable para los dos
casos cambiando su contenido.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span> <span class="n">appearance</span><span class="o">=</span><span class="s2">&quot;outline&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span><span class="n">Ciudad</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">label</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nb">input</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span> <span class="n">aria</span><span class="o">-</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number&quot;</span> <span class="n">matInput</span> <span class="n">formControlName</span><span class="o">=</span><span class="s2">&quot;ciudad&quot;</span> <span class="p">[</span><span class="n">matAutocomplete</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">autocomplete</span> <span class="c1">#auto=&quot;matAutocomplete&quot;&gt;</span>
        <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">option</span> <span class="o">*</span><span class="n">ngFor</span><span class="o">=</span><span class="s2">&quot;let municipio of filteredMunicipios | async&quot;</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;municipio&quot;</span><span class="o">&gt;</span>
            <span class="p">{{</span><span class="n">municipio</span><span class="p">}}</span>
        <span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">option</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">autocomplete</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span> <span class="o">*</span><span class="n">ngIf</span><span class="o">=</span><span class="s2">&quot;registerForm.controls.ciudad.invalid&quot;</span><span class="o">&gt;</span><span class="n">Ingrese</span> <span class="n">una</span> <span class="n">ciudad</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">error</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">form</span><span class="o">-</span><span class="n">field</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>El formulario incluía una sesión donde se debía ingresar de 1 a 3 habilidades mediante checkbox,
para ello se declaró e inicializo un array con las habilidades preestablecida y un contador de habilidades.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">listaHabi</span><span class="p">:</span> <span class="nb">any</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Autoconocimiento&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Empatía&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Comunicación asertiva&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Pensamiento crítico&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Toma de decisiones&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Adaptación&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Comunicación&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Trabajo en equipo&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Capacidad de asociación&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nb">id</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Razonamiento&#39;</span> <span class="p">},</span>
<span class="p">];</span>
<span class="n">nHabilidaddes</span><span class="p">:</span><span class="n">number</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>Para el control y majeo de los checkbox se creó un formGoup con un array de forms</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">checkboxForm</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FormGroup</span><span class="p">({</span>
    <span class="n">habiForm</span><span class="p">:</span> <span class="n">new</span> <span class="n">FormArray</span><span class="p">([],</span> <span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">)</span>
<span class="p">});</span>
</pre></div>
</div>
<p>El campo de los checkbox  en el HTML es el siguiente.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">form</span> <span class="p">[</span><span class="n">formGroup</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;checkboxForm&quot;</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">table</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;tbl-habilidades&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">section</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;section&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">ul</span> <span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">li</span> <span class="o">*</span><span class="n">ngFor</span><span class="o">=</span><span class="s2">&quot;let hab of listaHabi&quot;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span>   <span class="n">mat</span><span class="o">-</span><span class="n">checkbox</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;example-margin&quot;</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;hab.name&quot;</span> <span class="p">(</span><span class="n">change</span><span class="p">)</span><span class="o">=</span><span class="s2">&quot;onCheckboxChange($event)&quot;</span><span class="o">&gt;</span><span class="p">{{</span><span class="n">hab</span><span class="o">.</span><span class="n">name</span><span class="p">}}</span><span class="o">&lt;/</span><span class="n">mat</span><span class="o">-</span><span class="n">checkbox</span><span class="o">&gt;</span>
                <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">ul</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">table</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">form</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Cada vez que un checkbox sea seleccionado o cambie su estado se ejecuta el siguiente método que
obtiene el array de forms y se comprueba si ha sido seleccionado y  el contador de
habilidades esta en el rango entre 1 y 3 se suma el formContro al array de forms y
se suma el contador de habilidades, si contador de habilidades llega al límite entonces
si el checkbox seleccionado es des marcado se elimina  ese formControl del array de forms de
lo contrario no permitirá seleccionar más checkbox.</p>
<p>Si el contador de habilidades vuelve a ser 0 por deseleccionar todas las habilidades el
fromControl principal es limpiado y actualizado su validador de requerido inhabilitando
el botón de enviar el formulario.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">onCheckboxChange</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">const</span> <span class="n">habiForm</span><span class="p">:</span> <span class="n">FormArray</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">checkboxForm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;habiForm&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FormArray</span><span class="p">;</span>
    <span class="o">//</span><span class="n">si</span> <span class="n">lo</span> <span class="n">chuliaron</span> <span class="n">agrega</span> <span class="n">al</span> <span class="n">array</span> <span class="n">siempre</span> <span class="n">que</span> <span class="n">numero</span> <span class="n">de</span> <span class="n">habilidades</span> <span class="n">sea</span> <span class="n">menor</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">checked</span> <span class="o">&amp;&amp;</span> <span class="n">this</span><span class="o">.</span><span class="n">nHabilidaddes</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">habiForm</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">new</span> <span class="n">FormControl</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">value</span><span class="p">));</span>
        <span class="n">this</span><span class="o">.</span><span class="n">nHabilidaddes</span><span class="o">++</span><span class="p">;</span>
        <span class="o">//</span><span class="n">metodo</span> <span class="n">que</span> <span class="n">actuliza</span> <span class="n">las</span> <span class="n">habilidades</span> <span class="n">con</span> <span class="n">el</span> <span class="n">formControl</span> <span class="n">principal</span>
        <span class="n">this</span><span class="o">.</span><span class="n">validarHabilidades</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="o">//</span><span class="n">si</span> <span class="n">numero</span> <span class="n">la</span> <span class="n">habilidad</span> <span class="n">se</span> <span class="n">desmarca</span> <span class="n">elimina</span> <span class="n">habilidad</span>
    <span class="k">if</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">checked</span><span class="o">==</span><span class="n">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">const</span> <span class="n">index</span> <span class="o">=</span> <span class="n">habiForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">findIndex</span><span class="p">(</span><span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="o">===</span> <span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>
        <span class="n">habiForm</span><span class="o">.</span><span class="n">removeAt</span><span class="p">(</span><span class="n">index</span><span class="p">);</span>
        <span class="o">//</span><span class="n">metodo</span> <span class="n">que</span> <span class="n">actuliza</span> <span class="n">las</span> <span class="n">habilidades</span> <span class="n">con</span> <span class="n">el</span> <span class="n">formControl</span> <span class="n">principal</span>
        <span class="n">this</span><span class="o">.</span><span class="n">validarHabilidades</span><span class="p">();</span>
        <span class="n">this</span><span class="o">.</span><span class="n">nHabilidaddes</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="o">//</span><span class="n">si</span> <span class="n">numero</span> <span class="n">de</span> <span class="n">habilidades</span> <span class="n">esta</span> <span class="n">al</span> <span class="n">limite</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">no</span> <span class="n">agrega</span> <span class="n">nada</span> <span class="n">y</span> <span class="n">no</span> <span class="n">permite</span> <span class="n">chulear</span>
    <span class="k">else</span><span class="p">{</span>
        <span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">_checked</span><span class="o">=</span><span class="n">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="p">}</span>

    <span class="o">//</span><span class="n">si</span> <span class="n">no</span> <span class="n">hay</span> <span class="n">habilidades</span> <span class="n">selecionadas</span> <span class="n">no</span> <span class="n">habilita</span> <span class="n">el</span> <span class="n">boton</span> <span class="n">de</span> <span class="n">registrarse</span>
    <span class="k">if</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">nHabilidaddes</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="o">//</span><span class="n">restauro</span> <span class="n">el</span> <span class="n">formControl</span> <span class="n">principal</span><span class="p">,</span> <span class="n">limpiandolo</span><span class="p">,</span> <span class="n">agregando</span> <span class="n">el</span> <span class="n">validador</span> <span class="n">y</span> <span class="n">actualizandolo</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">setValue</span><span class="p">([]);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">setValidators</span><span class="p">([</span><span class="n">Validators</span><span class="o">.</span><span class="n">required</span><span class="p">]);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">updateValueAndValidity</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="o">//</span><span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>El método validarHabilidades() llamado internamente cuando un checkbox cambia su estado es
el encargado de obtener el valor de la habilidad y asignarlo al formControl principal de
habilidades del cual se tomara su valor parar registrarlo en la base de datos.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">validarHabilidades</span><span class="p">(){</span>

    <span class="o">//</span><span class="n">obtengo</span> <span class="n">los</span> <span class="n">valores</span> <span class="n">de</span> <span class="n">FormGroup</span>
    <span class="n">const</span> <span class="n">ob</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">checkboxForm</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
    <span class="o">//</span><span class="n">obtengo</span> <span class="n">el</span> <span class="n">array</span> <span class="n">habForm</span> <span class="n">de</span> <span class="n">ob</span> <span class="n">ostenido</span> <span class="n">de</span> <span class="n">FormGroup</span>
    <span class="n">const</span> <span class="p">{</span> <span class="n">habiForm</span> <span class="p">}</span> <span class="o">=</span> <span class="n">ob</span><span class="p">;</span>

    <span class="o">//</span><span class="n">para</span> <span class="n">almacenar</span> <span class="n">las</span> <span class="n">habilidades</span>
    <span class="n">let</span> <span class="n">habilidadesIn</span><span class="p">:</span> <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">let</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">habiForm</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="n">habilidadesIn</span> <span class="o">+=</span> <span class="n">habiForm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; / &quot;</span><span class="p">;</span>

    <span class="p">}</span>
    <span class="o">//</span><span class="n">asigno</span> <span class="n">las</span> <span class="n">habilidaesIn</span> <span class="n">al</span> <span class="n">valor</span> <span class="k">del</span> <span class="n">formcontrol</span> <span class="n">habilidaes</span> <span class="n">para</span> <span class="n">que</span> <span class="n">lo</span> <span class="n">registre</span> <span class="n">en</span> <span class="n">la</span> <span class="n">bd</span>
    <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">habilidades</span><span class="o">.</span><span class="n">setValue</span><span class="p">([</span><span class="n">habilidadesIn</span><span class="p">]);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Para registrar en la base de datos se emplea el siguiente método donde hace otra verificación sobre la cedula y
el email que es redundante dado que ya se validó, se le asigna una foto al formControl photoUrl por
defecto para su perfil y se procede a realizar el registro en la base de datos, también se muestra
un modal agradeciendo el registro y se redirige a la vista de inicio.</p>
<p>Al momento hacer el registro también se crea un usuario en el sistema mediante su email, siendo este de email y
contraseña con el cual tendrá acceso al sistema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">public</span> <span class="n">onRegister</span><span class="p">(</span><span class="n">form</span><span class="p">,</span> <span class="n">documentId</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">documentId</span><span class="p">)</span> <span class="p">{</span>

    <span class="o">//</span><span class="n">verifica</span> <span class="n">el</span> <span class="n">resultado</span> <span class="k">del</span> <span class="n">metodo</span> <span class="n">verificar</span> <span class="n">existencia</span> <span class="n">de</span> <span class="n">correo</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">ValidarExistenciaCorreo</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="o">==</span> <span class="n">false</span> <span class="o">&amp;&amp;</span>
        <span class="n">this</span><span class="o">.</span><span class="n">ValidarExistenciaCedula</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cedula&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="n">false</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="o">//</span> <span class="n">se</span> <span class="n">le</span> <span class="n">asigan</span> <span class="n">una</span> <span class="n">foto</span> <span class="n">por</span> <span class="n">defecto</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">photoUrl</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;https://firebasestorage.googleapis.com/v0/b/teamdc-c1083.appspot.com/o/uploads</span><span class="si">%2F</span><span class="s2">Logo.png?alt=media&amp;token=4c51f16d-bb24-4845-9961-b8145ce65a1b&quot;</span><span class="p">);</span>
        <span class="o">//</span> <span class="n">se</span> <span class="n">realiza</span> <span class="n">el</span> <span class="n">registro</span> <span class="n">en</span> <span class="n">la</span> <span class="n">bd</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registrosServiceF</span><span class="o">.</span><span class="n">crearRegistro</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>

        <span class="o">//</span><span class="n">se</span> <span class="n">presenta</span> <span class="n">un</span> <span class="n">modal</span>
        <span class="n">const</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="n">mensaje</span><span class="p">:</span><span class="s1">&#39;Gracias por registrarte&#39;</span><span class="p">};</span>
        <span class="n">this</span><span class="o">.</span><span class="n">openDialog</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
        <span class="o">//</span><span class="n">se</span> <span class="n">redirige</span> <span class="n">a</span> <span class="n">la</span> <span class="n">pagina</span> <span class="n">home</span>
        <span class="n">this</span><span class="o">.</span><span class="n">router</span><span class="o">.</span><span class="n">navigate</span><span class="p">([</span><span class="s1">&#39;/home&#39;</span><span class="p">]);</span>

        <span class="p">},</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
        <span class="p">});</span>

        <span class="n">const</span> <span class="n">result</span><span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">afAuth</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">createUserWithEmailAndPassword</span><span class="p">(</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">this</span><span class="o">.</span><span class="n">registerForm</span><span class="o">.</span><span class="n">controls</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>


    <span class="p">}</span>
<span class="p">}</span><span class="o">|</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="registros.html" class="btn btn-neutral float-right" title="Registros" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mi%20Perfil.html" class="btn btn-neutral float-left" title="Mi Perfil" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Karen Gómez y Ronal Landazabal

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>